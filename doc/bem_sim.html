<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<meta name="generator" content="Asciidoctor 2.0.17">
<meta name="author" content="Kentaro Hanson">
<title>bem_sim</title>
<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:300,300italic,400,400italic,600,600italic%7CNoto+Serif:400,400italic,700,700italic%7CDroid+Sans+Mono:400,700">
<style>
/*! Asciidoctor default stylesheet | MIT License | https://asciidoctor.org */
/* Uncomment the following line when using as a custom stylesheet */
/* @import "https://fonts.googleapis.com/css?family=Open+Sans:300,300italic,400,400italic,600,600italic%7CNoto+Serif:400,400italic,700,700italic%7CDroid+Sans+Mono:400,700"; */
html{font-family:sans-serif;-webkit-text-size-adjust:100%}
a{background:none}
a:focus{outline:thin dotted}
a:active,a:hover{outline:0}
h1{font-size:2em;margin:.67em 0}
b,strong{font-weight:bold}
abbr{font-size:.9em}
abbr[title]{cursor:help;border-bottom:1px dotted #dddddf;text-decoration:none}
dfn{font-style:italic}
hr{height:0}
mark{background:#ff0;color:#000}
code,kbd,pre,samp{font-family:monospace;font-size:1em}
pre{white-space:pre-wrap}
q{quotes:"\201C" "\201D" "\2018" "\2019"}
small{font-size:80%}
sub,sup{font-size:75%;line-height:0;position:relative;vertical-align:baseline}
sup{top:-.5em}
sub{bottom:-.25em}
img{border:0}
svg:not(:root){overflow:hidden}
figure{margin:0}
audio,video{display:inline-block}
audio:not([controls]){display:none;height:0}
fieldset{border:1px solid silver;margin:0 2px;padding:.35em .625em .75em}
legend{border:0;padding:0}
button,input,select,textarea{font-family:inherit;font-size:100%;margin:0}
button,input{line-height:normal}
button,select{text-transform:none}
button,html input[type=button],input[type=reset],input[type=submit]{-webkit-appearance:button;cursor:pointer}
button[disabled],html input[disabled]{cursor:default}
input[type=checkbox],input[type=radio]{padding:0}
button::-moz-focus-inner,input::-moz-focus-inner{border:0;padding:0}
textarea{overflow:auto;vertical-align:top}
table{border-collapse:collapse;border-spacing:0}
*,::before,::after{box-sizing:border-box}
html,body{font-size:100%}
body{background:#fff;color:rgba(0,0,0,.8);padding:0;margin:0;font-family:"Noto Serif","DejaVu Serif",serif;line-height:1;position:relative;cursor:auto;-moz-tab-size:4;-o-tab-size:4;tab-size:4;word-wrap:anywhere;-moz-osx-font-smoothing:grayscale;-webkit-font-smoothing:antialiased}
a:hover{cursor:pointer}
img,object,embed{max-width:100%;height:auto}
object,embed{height:100%}
img{-ms-interpolation-mode:bicubic}
.left{float:left!important}
.right{float:right!important}
.text-left{text-align:left!important}
.text-right{text-align:right!important}
.text-center{text-align:center!important}
.text-justify{text-align:justify!important}
.hide{display:none}
img,object,svg{display:inline-block;vertical-align:middle}
textarea{height:auto;min-height:50px}
select{width:100%}
.subheader,.admonitionblock td.content>.title,.audioblock>.title,.exampleblock>.title,.imageblock>.title,.listingblock>.title,.literalblock>.title,.stemblock>.title,.openblock>.title,.paragraph>.title,.quoteblock>.title,table.tableblock>.title,.verseblock>.title,.videoblock>.title,.dlist>.title,.olist>.title,.ulist>.title,.qlist>.title,.hdlist>.title{line-height:1.45;color:#7a2518;font-weight:400;margin-top:0;margin-bottom:.25em}
div,dl,dt,dd,ul,ol,li,h1,h2,h3,#toctitle,.sidebarblock>.content>.title,h4,h5,h6,pre,form,p,blockquote,th,td{margin:0;padding:0}
a{color:#2156a5;text-decoration:underline;line-height:inherit}
a:hover,a:focus{color:#1d4b8f}
a img{border:0}
p{line-height:1.6;margin-bottom:1.25em;text-rendering:optimizeLegibility}
p aside{font-size:.875em;line-height:1.35;font-style:italic}
h1,h2,h3,#toctitle,.sidebarblock>.content>.title,h4,h5,h6{font-family:"Open Sans","DejaVu Sans",sans-serif;font-weight:300;font-style:normal;color:#ba3925;text-rendering:optimizeLegibility;margin-top:1em;margin-bottom:.5em;line-height:1.0125em}
h1 small,h2 small,h3 small,#toctitle small,.sidebarblock>.content>.title small,h4 small,h5 small,h6 small{font-size:60%;color:#e99b8f;line-height:0}
h1{font-size:2.125em}
h2{font-size:1.6875em}
h3,#toctitle,.sidebarblock>.content>.title{font-size:1.375em}
h4,h5{font-size:1.125em}
h6{font-size:1em}
hr{border:solid #dddddf;border-width:1px 0 0;clear:both;margin:1.25em 0 1.1875em}
em,i{font-style:italic;line-height:inherit}
strong,b{font-weight:bold;line-height:inherit}
small{font-size:60%;line-height:inherit}
code{font-family:"Droid Sans Mono","DejaVu Sans Mono",monospace;font-weight:400;color:rgba(0,0,0,.9)}
ul,ol,dl{line-height:1.6;margin-bottom:1.25em;list-style-position:outside;font-family:inherit}
ul,ol{margin-left:1.5em}
ul li ul,ul li ol{margin-left:1.25em;margin-bottom:0}
ul.square li ul,ul.circle li ul,ul.disc li ul{list-style:inherit}
ul.square{list-style-type:square}
ul.circle{list-style-type:circle}
ul.disc{list-style-type:disc}
ol li ul,ol li ol{margin-left:1.25em;margin-bottom:0}
dl dt{margin-bottom:.3125em;font-weight:bold}
dl dd{margin-bottom:1.25em}
blockquote{margin:0 0 1.25em;padding:.5625em 1.25em 0 1.1875em;border-left:1px solid #ddd}
blockquote,blockquote p{line-height:1.6;color:rgba(0,0,0,.85)}
@media screen and (min-width:768px){h1,h2,h3,#toctitle,.sidebarblock>.content>.title,h4,h5,h6{line-height:1.2}
h1{font-size:2.75em}
h2{font-size:2.3125em}
h3,#toctitle,.sidebarblock>.content>.title{font-size:1.6875em}
h4{font-size:1.4375em}}
table{background:#fff;margin-bottom:1.25em;border:1px solid #dedede;word-wrap:normal}
table thead,table tfoot{background:#f7f8f7}
table thead tr th,table thead tr td,table tfoot tr th,table tfoot tr td{padding:.5em .625em .625em;font-size:inherit;color:rgba(0,0,0,.8);text-align:left}
table tr th,table tr td{padding:.5625em .625em;font-size:inherit;color:rgba(0,0,0,.8)}
table tr.even,table tr.alt{background:#f8f8f7}
table thead tr th,table tfoot tr th,table tbody tr td,table tr td,table tfoot tr td{line-height:1.6}
h1,h2,h3,#toctitle,.sidebarblock>.content>.title,h4,h5,h6{line-height:1.2;word-spacing:-.05em}
h1 strong,h2 strong,h3 strong,#toctitle strong,.sidebarblock>.content>.title strong,h4 strong,h5 strong,h6 strong{font-weight:400}
.center{margin-left:auto;margin-right:auto}
.stretch{width:100%}
.clearfix::before,.clearfix::after,.float-group::before,.float-group::after{content:" ";display:table}
.clearfix::after,.float-group::after{clear:both}
:not(pre).nobreak{word-wrap:normal}
:not(pre).nowrap{white-space:nowrap}
:not(pre).pre-wrap{white-space:pre-wrap}
:not(pre):not([class^=L])>code{font-size:.9375em;font-style:normal!important;letter-spacing:0;padding:.1em .5ex;word-spacing:-.15em;background:#f7f7f8;border-radius:4px;line-height:1.45;text-rendering:optimizeSpeed}
pre{color:rgba(0,0,0,.9);font-family:"Droid Sans Mono","DejaVu Sans Mono",monospace;line-height:1.45;text-rendering:optimizeSpeed}
pre code,pre pre{color:inherit;font-size:inherit;line-height:inherit}
pre>code{display:block}
pre.nowrap,pre.nowrap pre{white-space:pre;word-wrap:normal}
em em{font-style:normal}
strong strong{font-weight:400}
.keyseq{color:rgba(51,51,51,.8)}
kbd{font-family:"Droid Sans Mono","DejaVu Sans Mono",monospace;display:inline-block;color:rgba(0,0,0,.8);font-size:.65em;line-height:1.45;background:#f7f7f7;border:1px solid #ccc;border-radius:3px;box-shadow:0 1px 0 rgba(0,0,0,.2),inset 0 0 0 .1em #fff;margin:0 .15em;padding:.2em .5em;vertical-align:middle;position:relative;top:-.1em;white-space:nowrap}
.keyseq kbd:first-child{margin-left:0}
.keyseq kbd:last-child{margin-right:0}
.menuseq,.menuref{color:#000}
.menuseq b:not(.caret),.menuref{font-weight:inherit}
.menuseq{word-spacing:-.02em}
.menuseq b.caret{font-size:1.25em;line-height:.8}
.menuseq i.caret{font-weight:bold;text-align:center;width:.45em}
b.button::before,b.button::after{position:relative;top:-1px;font-weight:400}
b.button::before{content:"[";padding:0 3px 0 2px}
b.button::after{content:"]";padding:0 2px 0 3px}
p a>code:hover{color:rgba(0,0,0,.9)}
#header,#content,#footnotes,#footer{width:100%;margin:0 auto;max-width:62.5em;*zoom:1;position:relative;padding-left:.9375em;padding-right:.9375em}
#header::before,#header::after,#content::before,#content::after,#footnotes::before,#footnotes::after,#footer::before,#footer::after{content:" ";display:table}
#header::after,#content::after,#footnotes::after,#footer::after{clear:both}
#content{margin-top:1.25em}
#content::before{content:none}
#header>h1:first-child{color:rgba(0,0,0,.85);margin-top:2.25rem;margin-bottom:0}
#header>h1:first-child+#toc{margin-top:8px;border-top:1px solid #dddddf}
#header>h1:only-child,body.toc2 #header>h1:nth-last-child(2){border-bottom:1px solid #dddddf;padding-bottom:8px}
#header .details{border-bottom:1px solid #dddddf;line-height:1.45;padding-top:.25em;padding-bottom:.25em;padding-left:.25em;color:rgba(0,0,0,.6);display:flex;flex-flow:row wrap}
#header .details span:first-child{margin-left:-.125em}
#header .details span.email a{color:rgba(0,0,0,.85)}
#header .details br{display:none}
#header .details br+span::before{content:"\00a0\2013\00a0"}
#header .details br+span.author::before{content:"\00a0\22c5\00a0";color:rgba(0,0,0,.85)}
#header .details br+span#revremark::before{content:"\00a0|\00a0"}
#header #revnumber{text-transform:capitalize}
#header #revnumber::after{content:"\00a0"}
#content>h1:first-child:not([class]){color:rgba(0,0,0,.85);border-bottom:1px solid #dddddf;padding-bottom:8px;margin-top:0;padding-top:1rem;margin-bottom:1.25rem}
#toc{border-bottom:1px solid #e7e7e9;padding-bottom:.5em}
#toc>ul{margin-left:.125em}
#toc ul.sectlevel0>li>a{font-style:italic}
#toc ul.sectlevel0 ul.sectlevel1{margin:.5em 0}
#toc ul{font-family:"Open Sans","DejaVu Sans",sans-serif;list-style-type:none}
#toc li{line-height:1.3334;margin-top:.3334em}
#toc a{text-decoration:none}
#toc a:active{text-decoration:underline}
#toctitle{color:#7a2518;font-size:1.2em}
@media screen and (min-width:768px){#toctitle{font-size:1.375em}
body.toc2{padding-left:15em;padding-right:0}
#toc.toc2{margin-top:0!important;background:#f8f8f7;position:fixed;width:15em;left:0;top:0;border-right:1px solid #e7e7e9;border-top-width:0!important;border-bottom-width:0!important;z-index:1000;padding:1.25em 1em;height:100%;overflow:auto}
#toc.toc2 #toctitle{margin-top:0;margin-bottom:.8rem;font-size:1.2em}
#toc.toc2>ul{font-size:.9em;margin-bottom:0}
#toc.toc2 ul ul{margin-left:0;padding-left:1em}
#toc.toc2 ul.sectlevel0 ul.sectlevel1{padding-left:0;margin-top:.5em;margin-bottom:.5em}
body.toc2.toc-right{padding-left:0;padding-right:15em}
body.toc2.toc-right #toc.toc2{border-right-width:0;border-left:1px solid #e7e7e9;left:auto;right:0}}
@media screen and (min-width:1280px){body.toc2{padding-left:20em;padding-right:0}
#toc.toc2{width:20em}
#toc.toc2 #toctitle{font-size:1.375em}
#toc.toc2>ul{font-size:.95em}
#toc.toc2 ul ul{padding-left:1.25em}
body.toc2.toc-right{padding-left:0;padding-right:20em}}
#content #toc{border:1px solid #e0e0dc;margin-bottom:1.25em;padding:1.25em;background:#f8f8f7;border-radius:4px}
#content #toc>:first-child{margin-top:0}
#content #toc>:last-child{margin-bottom:0}
#footer{max-width:none;background:rgba(0,0,0,.8);padding:1.25em}
#footer-text{color:hsla(0,0%,100%,.8);line-height:1.44}
#content{margin-bottom:.625em}
.sect1{padding-bottom:.625em}
@media screen and (min-width:768px){#content{margin-bottom:1.25em}
.sect1{padding-bottom:1.25em}}
.sect1:last-child{padding-bottom:0}
.sect1+.sect1{border-top:1px solid #e7e7e9}
#content h1>a.anchor,h2>a.anchor,h3>a.anchor,#toctitle>a.anchor,.sidebarblock>.content>.title>a.anchor,h4>a.anchor,h5>a.anchor,h6>a.anchor{position:absolute;z-index:1001;width:1.5ex;margin-left:-1.5ex;display:block;text-decoration:none!important;visibility:hidden;text-align:center;font-weight:400}
#content h1>a.anchor::before,h2>a.anchor::before,h3>a.anchor::before,#toctitle>a.anchor::before,.sidebarblock>.content>.title>a.anchor::before,h4>a.anchor::before,h5>a.anchor::before,h6>a.anchor::before{content:"\00A7";font-size:.85em;display:block;padding-top:.1em}
#content h1:hover>a.anchor,#content h1>a.anchor:hover,h2:hover>a.anchor,h2>a.anchor:hover,h3:hover>a.anchor,#toctitle:hover>a.anchor,.sidebarblock>.content>.title:hover>a.anchor,h3>a.anchor:hover,#toctitle>a.anchor:hover,.sidebarblock>.content>.title>a.anchor:hover,h4:hover>a.anchor,h4>a.anchor:hover,h5:hover>a.anchor,h5>a.anchor:hover,h6:hover>a.anchor,h6>a.anchor:hover{visibility:visible}
#content h1>a.link,h2>a.link,h3>a.link,#toctitle>a.link,.sidebarblock>.content>.title>a.link,h4>a.link,h5>a.link,h6>a.link{color:#ba3925;text-decoration:none}
#content h1>a.link:hover,h2>a.link:hover,h3>a.link:hover,#toctitle>a.link:hover,.sidebarblock>.content>.title>a.link:hover,h4>a.link:hover,h5>a.link:hover,h6>a.link:hover{color:#a53221}
details,.audioblock,.imageblock,.literalblock,.listingblock,.stemblock,.videoblock{margin-bottom:1.25em}
details{margin-left:1.25rem}
details>summary{cursor:pointer;display:block;position:relative;line-height:1.6;margin-bottom:.625rem;outline:none;-webkit-tap-highlight-color:transparent}
details>summary::-webkit-details-marker{display:none}
details>summary::before{content:"";border:solid transparent;border-left:solid;border-width:.3em 0 .3em .5em;position:absolute;top:.5em;left:-1.25rem;transform:translateX(15%)}
details[open]>summary::before{border:solid transparent;border-top:solid;border-width:.5em .3em 0;transform:translateY(15%)}
details>summary::after{content:"";width:1.25rem;height:1em;position:absolute;top:.3em;left:-1.25rem}
.admonitionblock td.content>.title,.audioblock>.title,.exampleblock>.title,.imageblock>.title,.listingblock>.title,.literalblock>.title,.stemblock>.title,.openblock>.title,.paragraph>.title,.quoteblock>.title,table.tableblock>.title,.verseblock>.title,.videoblock>.title,.dlist>.title,.olist>.title,.ulist>.title,.qlist>.title,.hdlist>.title{text-rendering:optimizeLegibility;text-align:left;font-family:"Noto Serif","DejaVu Serif",serif;font-size:1rem;font-style:italic}
table.tableblock.fit-content>caption.title{white-space:nowrap;width:0}
.paragraph.lead>p,#preamble>.sectionbody>[class=paragraph]:first-of-type p{font-size:1.21875em;line-height:1.6;color:rgba(0,0,0,.85)}
.admonitionblock>table{border-collapse:separate;border:0;background:none;width:100%}
.admonitionblock>table td.icon{text-align:center;width:80px}
.admonitionblock>table td.icon img{max-width:none}
.admonitionblock>table td.icon .title{font-weight:bold;font-family:"Open Sans","DejaVu Sans",sans-serif;text-transform:uppercase}
.admonitionblock>table td.content{padding-left:1.125em;padding-right:1.25em;border-left:1px solid #dddddf;color:rgba(0,0,0,.6);word-wrap:anywhere}
.admonitionblock>table td.content>:last-child>:last-child{margin-bottom:0}
.exampleblock>.content{border:1px solid #e6e6e6;margin-bottom:1.25em;padding:1.25em;background:#fff;border-radius:4px}
.exampleblock>.content>:first-child{margin-top:0}
.exampleblock>.content>:last-child{margin-bottom:0}
.sidebarblock{border:1px solid #dbdbd6;margin-bottom:1.25em;padding:1.25em;background:#f3f3f2;border-radius:4px}
.sidebarblock>:first-child{margin-top:0}
.sidebarblock>:last-child{margin-bottom:0}
.sidebarblock>.content>.title{color:#7a2518;margin-top:0;text-align:center}
.exampleblock>.content>:last-child>:last-child,.exampleblock>.content .olist>ol>li:last-child>:last-child,.exampleblock>.content .ulist>ul>li:last-child>:last-child,.exampleblock>.content .qlist>ol>li:last-child>:last-child,.sidebarblock>.content>:last-child>:last-child,.sidebarblock>.content .olist>ol>li:last-child>:last-child,.sidebarblock>.content .ulist>ul>li:last-child>:last-child,.sidebarblock>.content .qlist>ol>li:last-child>:last-child{margin-bottom:0}
.literalblock pre,.listingblock>.content>pre{border-radius:4px;overflow-x:auto;padding:1em;font-size:.8125em}
@media screen and (min-width:768px){.literalblock pre,.listingblock>.content>pre{font-size:.90625em}}
@media screen and (min-width:1280px){.literalblock pre,.listingblock>.content>pre{font-size:1em}}
.literalblock pre,.listingblock>.content>pre:not(.highlight),.listingblock>.content>pre[class=highlight],.listingblock>.content>pre[class^="highlight "]{background:#f7f7f8}
.literalblock.output pre{color:#f7f7f8;background:rgba(0,0,0,.9)}
.listingblock>.content{position:relative}
.listingblock code[data-lang]::before{display:none;content:attr(data-lang);position:absolute;font-size:.75em;top:.425rem;right:.5rem;line-height:1;text-transform:uppercase;color:inherit;opacity:.5}
.listingblock:hover code[data-lang]::before{display:block}
.listingblock.terminal pre .command::before{content:attr(data-prompt);padding-right:.5em;color:inherit;opacity:.5}
.listingblock.terminal pre .command:not([data-prompt])::before{content:"$"}
.listingblock pre.highlightjs{padding:0}
.listingblock pre.highlightjs>code{padding:1em;border-radius:4px}
.listingblock pre.prettyprint{border-width:0}
.prettyprint{background:#f7f7f8}
pre.prettyprint .linenums{line-height:1.45;margin-left:2em}
pre.prettyprint li{background:none;list-style-type:inherit;padding-left:0}
pre.prettyprint li code[data-lang]::before{opacity:1}
pre.prettyprint li:not(:first-child) code[data-lang]::before{display:none}
table.linenotable{border-collapse:separate;border:0;margin-bottom:0;background:none}
table.linenotable td[class]{color:inherit;vertical-align:top;padding:0;line-height:inherit;white-space:normal}
table.linenotable td.code{padding-left:.75em}
table.linenotable td.linenos,pre.pygments .linenos{border-right:1px solid;opacity:.35;padding-right:.5em;-webkit-user-select:none;-moz-user-select:none;-ms-user-select:none;user-select:none}
pre.pygments span.linenos{display:inline-block;margin-right:.75em}
.quoteblock{margin:0 1em 1.25em 1.5em;display:table}
.quoteblock:not(.excerpt)>.title{margin-left:-1.5em;margin-bottom:.75em}
.quoteblock blockquote,.quoteblock p{color:rgba(0,0,0,.85);font-size:1.15rem;line-height:1.75;word-spacing:.1em;letter-spacing:0;font-style:italic;text-align:justify}
.quoteblock blockquote{margin:0;padding:0;border:0}
.quoteblock blockquote::before{content:"\201c";float:left;font-size:2.75em;font-weight:bold;line-height:.6em;margin-left:-.6em;color:#7a2518;text-shadow:0 1px 2px rgba(0,0,0,.1)}
.quoteblock blockquote>.paragraph:last-child p{margin-bottom:0}
.quoteblock .attribution{margin-top:.75em;margin-right:.5ex;text-align:right}
.verseblock{margin:0 1em 1.25em}
.verseblock pre{font-family:"Open Sans","DejaVu Sans",sans-serif;font-size:1.15rem;color:rgba(0,0,0,.85);font-weight:300;text-rendering:optimizeLegibility}
.verseblock pre strong{font-weight:400}
.verseblock .attribution{margin-top:1.25rem;margin-left:.5ex}
.quoteblock .attribution,.verseblock .attribution{font-size:.9375em;line-height:1.45;font-style:italic}
.quoteblock .attribution br,.verseblock .attribution br{display:none}
.quoteblock .attribution cite,.verseblock .attribution cite{display:block;letter-spacing:-.025em;color:rgba(0,0,0,.6)}
.quoteblock.abstract blockquote::before,.quoteblock.excerpt blockquote::before,.quoteblock .quoteblock blockquote::before{display:none}
.quoteblock.abstract blockquote,.quoteblock.abstract p,.quoteblock.excerpt blockquote,.quoteblock.excerpt p,.quoteblock .quoteblock blockquote,.quoteblock .quoteblock p{line-height:1.6;word-spacing:0}
.quoteblock.abstract{margin:0 1em 1.25em;display:block}
.quoteblock.abstract>.title{margin:0 0 .375em;font-size:1.15em;text-align:center}
.quoteblock.excerpt>blockquote,.quoteblock .quoteblock{padding:0 0 .25em 1em;border-left:.25em solid #dddddf}
.quoteblock.excerpt,.quoteblock .quoteblock{margin-left:0}
.quoteblock.excerpt blockquote,.quoteblock.excerpt p,.quoteblock .quoteblock blockquote,.quoteblock .quoteblock p{color:inherit;font-size:1.0625rem}
.quoteblock.excerpt .attribution,.quoteblock .quoteblock .attribution{color:inherit;font-size:.85rem;text-align:left;margin-right:0}
p.tableblock:last-child{margin-bottom:0}
td.tableblock>.content{margin-bottom:1.25em;word-wrap:anywhere}
td.tableblock>.content>:last-child{margin-bottom:-1.25em}
table.tableblock,th.tableblock,td.tableblock{border:0 solid #dedede}
table.grid-all>*>tr>*{border-width:1px}
table.grid-cols>*>tr>*{border-width:0 1px}
table.grid-rows>*>tr>*{border-width:1px 0}
table.frame-all{border-width:1px}
table.frame-ends{border-width:1px 0}
table.frame-sides{border-width:0 1px}
table.frame-none>colgroup+*>:first-child>*,table.frame-sides>colgroup+*>:first-child>*{border-top-width:0}
table.frame-none>:last-child>:last-child>*,table.frame-sides>:last-child>:last-child>*{border-bottom-width:0}
table.frame-none>*>tr>:first-child,table.frame-ends>*>tr>:first-child{border-left-width:0}
table.frame-none>*>tr>:last-child,table.frame-ends>*>tr>:last-child{border-right-width:0}
table.stripes-all>*>tr,table.stripes-odd>*>tr:nth-of-type(odd),table.stripes-even>*>tr:nth-of-type(even),table.stripes-hover>*>tr:hover{background:#f8f8f7}
th.halign-left,td.halign-left{text-align:left}
th.halign-right,td.halign-right{text-align:right}
th.halign-center,td.halign-center{text-align:center}
th.valign-top,td.valign-top{vertical-align:top}
th.valign-bottom,td.valign-bottom{vertical-align:bottom}
th.valign-middle,td.valign-middle{vertical-align:middle}
table thead th,table tfoot th{font-weight:bold}
tbody tr th{background:#f7f8f7}
tbody tr th,tbody tr th p,tfoot tr th,tfoot tr th p{color:rgba(0,0,0,.8);font-weight:bold}
p.tableblock>code:only-child{background:none;padding:0}
p.tableblock{font-size:1em}
ol{margin-left:1.75em}
ul li ol{margin-left:1.5em}
dl dd{margin-left:1.125em}
dl dd:last-child,dl dd:last-child>:last-child{margin-bottom:0}
li p,ul dd,ol dd,.olist .olist,.ulist .ulist,.ulist .olist,.olist .ulist{margin-bottom:.625em}
ul.checklist,ul.none,ol.none,ul.no-bullet,ol.no-bullet,ol.unnumbered,ul.unstyled,ol.unstyled{list-style-type:none}
ul.no-bullet,ol.no-bullet,ol.unnumbered{margin-left:.625em}
ul.unstyled,ol.unstyled{margin-left:0}
li>p:empty:only-child::before{content:"";display:inline-block}
ul.checklist>li>p:first-child{margin-left:-1em}
ul.checklist>li>p:first-child>.fa-square-o:first-child,ul.checklist>li>p:first-child>.fa-check-square-o:first-child{width:1.25em;font-size:.8em;position:relative;bottom:.125em}
ul.checklist>li>p:first-child>input[type=checkbox]:first-child{margin-right:.25em}
ul.inline{display:flex;flex-flow:row wrap;list-style:none;margin:0 0 .625em -1.25em}
ul.inline>li{margin-left:1.25em}
.unstyled dl dt{font-weight:400;font-style:normal}
ol.arabic{list-style-type:decimal}
ol.decimal{list-style-type:decimal-leading-zero}
ol.loweralpha{list-style-type:lower-alpha}
ol.upperalpha{list-style-type:upper-alpha}
ol.lowerroman{list-style-type:lower-roman}
ol.upperroman{list-style-type:upper-roman}
ol.lowergreek{list-style-type:lower-greek}
.hdlist>table,.colist>table{border:0;background:none}
.hdlist>table>tbody>tr,.colist>table>tbody>tr{background:none}
td.hdlist1,td.hdlist2{vertical-align:top;padding:0 .625em}
td.hdlist1{font-weight:bold;padding-bottom:1.25em}
td.hdlist2{word-wrap:anywhere}
.literalblock+.colist,.listingblock+.colist{margin-top:-.5em}
.colist td:not([class]):first-child{padding:.4em .75em 0;line-height:1;vertical-align:top}
.colist td:not([class]):first-child img{max-width:none}
.colist td:not([class]):last-child{padding:.25em 0}
.thumb,.th{line-height:0;display:inline-block;border:4px solid #fff;box-shadow:0 0 0 1px #ddd}
.imageblock.left{margin:.25em .625em 1.25em 0}
.imageblock.right{margin:.25em 0 1.25em .625em}
.imageblock>.title{margin-bottom:0}
.imageblock.thumb,.imageblock.th{border-width:6px}
.imageblock.thumb>.title,.imageblock.th>.title{padding:0 .125em}
.image.left,.image.right{margin-top:.25em;margin-bottom:.25em;display:inline-block;line-height:0}
.image.left{margin-right:.625em}
.image.right{margin-left:.625em}
a.image{text-decoration:none;display:inline-block}
a.image object{pointer-events:none}
sup.footnote,sup.footnoteref{font-size:.875em;position:static;vertical-align:super}
sup.footnote a,sup.footnoteref a{text-decoration:none}
sup.footnote a:active,sup.footnoteref a:active{text-decoration:underline}
#footnotes{padding-top:.75em;padding-bottom:.75em;margin-bottom:.625em}
#footnotes hr{width:20%;min-width:6.25em;margin:-.25em 0 .75em;border-width:1px 0 0}
#footnotes .footnote{padding:0 .375em 0 .225em;line-height:1.3334;font-size:.875em;margin-left:1.2em;margin-bottom:.2em}
#footnotes .footnote a:first-of-type{font-weight:bold;text-decoration:none;margin-left:-1.05em}
#footnotes .footnote:last-of-type{margin-bottom:0}
#content #footnotes{margin-top:-.625em;margin-bottom:0;padding:.75em 0}
div.unbreakable{page-break-inside:avoid}
.big{font-size:larger}
.small{font-size:smaller}
.underline{text-decoration:underline}
.overline{text-decoration:overline}
.line-through{text-decoration:line-through}
.aqua{color:#00bfbf}
.aqua-background{background:#00fafa}
.black{color:#000}
.black-background{background:#000}
.blue{color:#0000bf}
.blue-background{background:#0000fa}
.fuchsia{color:#bf00bf}
.fuchsia-background{background:#fa00fa}
.gray{color:#606060}
.gray-background{background:#7d7d7d}
.green{color:#006000}
.green-background{background:#007d00}
.lime{color:#00bf00}
.lime-background{background:#00fa00}
.maroon{color:#600000}
.maroon-background{background:#7d0000}
.navy{color:#000060}
.navy-background{background:#00007d}
.olive{color:#606000}
.olive-background{background:#7d7d00}
.purple{color:#600060}
.purple-background{background:#7d007d}
.red{color:#bf0000}
.red-background{background:#fa0000}
.silver{color:#909090}
.silver-background{background:#bcbcbc}
.teal{color:#006060}
.teal-background{background:#007d7d}
.white{color:#bfbfbf}
.white-background{background:#fafafa}
.yellow{color:#bfbf00}
.yellow-background{background:#fafa00}
span.icon>.fa{cursor:default}
a span.icon>.fa{cursor:inherit}
.admonitionblock td.icon [class^="fa icon-"]{font-size:2.5em;text-shadow:1px 1px 2px rgba(0,0,0,.5);cursor:default}
.admonitionblock td.icon .icon-note::before{content:"\f05a";color:#19407c}
.admonitionblock td.icon .icon-tip::before{content:"\f0eb";text-shadow:1px 1px 2px rgba(155,155,0,.8);color:#111}
.admonitionblock td.icon .icon-warning::before{content:"\f071";color:#bf6900}
.admonitionblock td.icon .icon-caution::before{content:"\f06d";color:#bf3400}
.admonitionblock td.icon .icon-important::before{content:"\f06a";color:#bf0000}
.conum[data-value]{display:inline-block;color:#fff!important;background:rgba(0,0,0,.8);border-radius:50%;text-align:center;font-size:.75em;width:1.67em;height:1.67em;line-height:1.67em;font-family:"Open Sans","DejaVu Sans",sans-serif;font-style:normal;font-weight:bold}
.conum[data-value] *{color:#fff!important}
.conum[data-value]+b{display:none}
.conum[data-value]::after{content:attr(data-value)}
pre .conum[data-value]{position:relative;top:-.125em}
b.conum *{color:inherit!important}
.conum:not([data-value]):empty{display:none}
dt,th.tableblock,td.content,div.footnote{text-rendering:optimizeLegibility}
h1,h2,p,td.content,span.alt,summary{letter-spacing:-.01em}
p strong,td.content strong,div.footnote strong{letter-spacing:-.005em}
p,blockquote,dt,td.content,span.alt,summary{font-size:1.0625rem}
p{margin-bottom:1.25rem}
.sidebarblock p,.sidebarblock dt,.sidebarblock td.content,p.tableblock{font-size:1em}
.exampleblock>.content{background:#fffef7;border-color:#e0e0dc;box-shadow:0 1px 4px #e0e0dc}
.print-only{display:none!important}
@page{margin:1.25cm .75cm}
@media print{*{box-shadow:none!important;text-shadow:none!important}
html{font-size:80%}
a{color:inherit!important;text-decoration:underline!important}
a.bare,a[href^="#"],a[href^="mailto:"]{text-decoration:none!important}
a[href^="http:"]:not(.bare)::after,a[href^="https:"]:not(.bare)::after{content:"(" attr(href) ")";display:inline-block;font-size:.875em;padding-left:.25em}
abbr[title]{border-bottom:1px dotted}
abbr[title]::after{content:" (" attr(title) ")"}
pre,blockquote,tr,img,object,svg{page-break-inside:avoid}
thead{display:table-header-group}
svg{max-width:100%}
p,blockquote,dt,td.content{font-size:1em;orphans:3;widows:3}
h2,h3,#toctitle,.sidebarblock>.content>.title{page-break-after:avoid}
#header,#content,#footnotes,#footer{max-width:none}
#toc,.sidebarblock,.exampleblock>.content{background:none!important}
#toc{border-bottom:1px solid #dddddf!important;padding-bottom:0!important}
body.book #header{text-align:center}
body.book #header>h1:first-child{border:0!important;margin:2.5em 0 1em}
body.book #header .details{border:0!important;display:block;padding:0!important}
body.book #header .details span:first-child{margin-left:0!important}
body.book #header .details br{display:block}
body.book #header .details br+span::before{content:none!important}
body.book #toc{border:0!important;text-align:left!important;padding:0!important;margin:0!important}
body.book #toc,body.book #preamble,body.book h1.sect0,body.book .sect1>h2{page-break-before:always}
.listingblock code[data-lang]::before{display:block}
#footer{padding:0 .9375em}
.hide-on-print{display:none!important}
.print-only{display:block!important}
.hide-for-print{display:none!important}
.show-for-print{display:inherit!important}}
@media amzn-kf8,print{#header>h1:first-child{margin-top:1.25rem}
.sect1{padding:0!important}
.sect1+.sect1{border:0}
#footer{background:none}
#footer-text{color:rgba(0,0,0,.6);font-size:.9em}}
@media amzn-kf8{#header,#content,#footnotes,#footer{padding:0}}
</style>
</head>
<body class="article data-line-1">
<div id="header">
<h1>bem_sim</h1>
<div class="details">
<span id="author" class="author">Kentaro Hanson</span><br>
</div>
</div>
<div id="content">
<div id="preamble">
<div class="sectionbody">
<div class="paragraph data-line-6">
<p>This class contains the variables needed to run a BEM free-surface simulation.</p>
</div>
</div>
</div>
<div class="sect1 data-line-8">
<h2 id="_properties">Properties</h2>
<div class="sectionbody">
<div class="ulist data-line-10">
<ul>
<li class="data-line-10">
<p><a href="#boundary"><code><strong>boundary</strong></code></a></p>
<div class="ulist data-line-11">
<ul>
<li class="data-line-11">
<p>Stores the necessary information to represent the boundary elements:</p>
<div class="ulist data-line-12">
<ul>
<li class="data-line-12">
<p><a href="#boundary_N"><code><strong>N</strong></code></a> - The number of nodes in the boundary</p>
</li>
<li class="data-line-13">
<p><a href="#boundary_x"><code><strong>x</strong></code></a> - Array of length <code>N</code> that represents the <em>x</em> values of each node</p>
</li>
<li class="data-line-14">
<p><a href="#boundary_x"><code><strong>z</strong></code></a> - Array of length <code>N</code> that represents the <em>z</em> values of each node</p>
</li>
<li class="data-line-15">
<p><a href="#boundary_doublenode"><code><strong>doublenode</strong></code></a> - Array of logical values (0 or 1) that represent whether or not the corresponding node is a <a href="bem_method.html" data-href="bem_method.html">double node</a>.</p>
</li>
<li class="data-line-16">
<p><a href="#boundary_fsstartend"><code><strong>FS_start</strong></code></a> - Index of the first free surface node</p>
</li>
<li class="data-line-17">
<p><a href="#boundary_fsstartend"><code><strong>FS_end</strong></code></a> - Index of the last free surface node</p>
</li>
<li class="data-line-18">
<p><a href="#boundary_phiFS"><code><strong>phi_FS</strong></code></a> - Velocity potential \$\phi\$ on the free surface</p>
</li>
</ul>
</div>
</li>
</ul>
</div>
</li>
<li class="data-line-20">
<p><a href="#interpolation"><code><strong>interpolation, interpolation_FS, interpolation_sliding</strong></code></a></p>
<div class="ulist data-line-21">
<ul>
<li class="data-line-21">
<p>Stores values for Lagrange interpolation. Currently only <code>M=1</code> is used on the full boundary and <code>M=4</code> is used on the sliding segment.</p>
<div class="ulist data-line-22">
<ul>
<li class="data-line-22">
<p><a href="#interpolation_M"><code><strong>M</strong></code></a> - The order of the Lagrange interpolation (order of the polynomial); <code>M+1</code> nodes are used.</p>
</li>
<li class="data-line-23">
<p><a href="#interpolation_lagrange"><code><strong>Lagrange</strong></code></a> - Coefficients of the Lagrange polynomials</p>
</li>
<li class="data-line-24">
<p><a href="#interpolation_lagrangep"><code><strong>Lagrange_prime</strong></code></a> - Coefficients of the derivatives of the Lagrange polynomials</p>
</li>
<li class="data-line-25">
<p><a href="#interpolation_lagrangepp"><code><strong>Lagrange_primeprime</strong></code></a> - Coefficients of the second derivatives of the Lagrange polynomials</p>
</li>
</ul>
</div>
</li>
</ul>
</div>
</li>
<li class="data-line-27">
<p><a href="#stepping"><code><strong>stepping</strong></code></a></p>
<div class="ulist data-line-28">
<ul>
<li class="data-line-28">
<p>Stores information relevant to time-stepping the simulation</p>
<div class="ulist data-line-29">
<ul>
<li class="data-line-29">
<p><a href="#stepping_t"><code><strong>t</strong></code></a> - The current time of the simulation</p>
</li>
<li class="data-line-30">
<p><a href="#stepping_dt"><code><strong>dt</strong></code></a> - The time step of the simulation</p>
</li>
<li class="data-line-31">
<p><a href="#stepping_store_dt"><code><strong>store_dt</strong></code></a> - Time interval between saving data to <code>history</code></p>
</li>
<li class="data-line-32">
<p><a href="#stepping_courant_number"><code><strong>courant_number</strong></code></a> - The Courant number of the simulation</p>
</li>
<li class="data-line-33">
<p><a href="#stepping_courant_lock"><code><strong>courant_lock</strong></code></a> - Whether to lock the Courant number or <code>dt</code> when stepping</p>
</li>
<li class="data-line-34">
<p><a href="#stepping_timestep_method"><code><strong>timestep_method</strong></code></a> - The integration scheme for time stepping</p>
</li>
</ul>
</div>
</li>
</ul>
</div>
</li>
<li class="data-line-35">
<p><a href="#history"><code><strong>history</strong></code></a></p>
<div class="ulist data-line-36">
<ul>
<li class="data-line-36">
<p>Stores prior states of the simulation</p>
<div class="ulist data-line-37">
<ul>
<li class="data-line-37">
<p><a href="#history_time"><code><strong>time</strong></code></a> - Times for each data point in history</p>
</li>
<li class="data-line-38">
<p><a href="#history_energy"><code><strong>energy</strong></code></a> - Calculated energy for each index in <code>time</code></p>
</li>
<li class="data-line-39">
<p><a href="#history_energy"><code><strong>KE</strong></code></a> - Calculated kinetic energy for each index in <code>time</code></p>
</li>
<li class="data-line-40">
<p><a href="#history_energy"><code><strong>PE</strong></code></a> - Calculated potential energy for each index in <code>time</code></p>
</li>
<li class="data-line-41">
<p><a href="#history_volume"><code><strong>volume</strong></code></a> - Calculated volume for each index in <code>time</code></p>
</li>
<li class="data-line-42">
<p><a href="#history_x_FS"><code><strong>x_FS</strong></code>,<code><strong>x_full</strong></code></a> - Calculated free surface or full boundary node <code>x</code> locations for each index in <code>time</code></p>
</li>
<li class="data-line-43">
<p><a href="#history_x_FS"><code><strong>z_FS</strong></code>,<code><strong>z_full</strong></code></a> - Calculated free surface or full boundary node <code>z</code> locations for each index in <code>time</code></p>
</li>
<li class="data-line-44">
<p><a href="#history_phi_FS"><code><strong>phi_FS</strong></code></a> - Calculated free surface velocity potential \$\phi\$ for each index in <code>time</code></p>
</li>
<li class="data-line-45">
<p><a href="#history_net_flux"><code><strong>net_flux</strong></code></a> - Calculated integral of flux \$\int_{\Gamma} \phi_n  d\Gamma\$ for each index in <code>time</code></p>
</li>
<li class="data-line-46">
<p><a href="#history_mean_water_level"><code><strong>mean_water_level</strong></code></a> - Calculated mean of \$\eta\$ for each index in <code>time</code></p>
</li>
<li class="data-line-47">
<p><a href="#history_condition_number"><code><strong>condition_number</strong></code></a> - Calculated condition number of the algebraic system for each index in <code>time</code></p>
</li>
</ul>
</div>
</li>
</ul>
</div>
</li>
<li class="data-line-48">
<p><a href="#meta"><code><strong>meta</strong></code></a></p>
<div class="ulist data-line-49">
<ul>
<li class="data-line-49">
<p>Stores metadata about the simulation. More values than the following may exist, but these ones exist for all simulations.</p>
<div class="ulist data-line-50">
<ul>
<li class="data-line-50">
<p><a href="#meta_a0"><code><strong>has_a0</strong></code></a> - Flag for whether or not to use an <code>a0</code> value in the simulation. This affects plotting.</p>
</li>
<li class="data-line-51">
<p><a href="#meta_plot_ylim"><code><strong>plot_ylim</strong></code></a> - If plotting is done, these are the <code>ylim</code> parameters</p>
</li>
<li class="data-line-52">
<p><a href="#meta_plot_ylim"><code><strong>plot_xlim</strong></code></a> - If plotting is done, these are the <code>xlim</code> parameters</p>
</li>
<li class="data-line-53">
<p><a href="#meta_sim_parallel_workers"><code><strong>sim_parallel_workers</strong></code></a> - Number of worker threads during intensive computation</p>
</li>
<li class="data-line-54">
<p><a href="#meta_g"><code><strong>g</strong></code></a> - Acceleration due to gravity</p>
</li>
<li class="data-line-55">
<p><a href="#meta_L"><code><strong>L</strong></code></a> - Length of the simulation (x-distance)</p>
</li>
<li class="data-line-56">
<p><a href="#meta_wall_resolution_factor"><code><strong>wall_resolution_factor</strong></code></a> - approximate ratio of node spacing on the wall relative to the bottom boundary and free surface</p>
</li>
<li class="data-line-57">
<p><a href="#meta_history_store_full_boundary"><code><strong>history_store_full_boundary</strong></code></a> - Whether or not the full boundary should be stored in history</p>
</li>
<li class="data-line-58">
<p><a href="#meta_history_store_angle_FS"><code><strong>history_store_angle_FS</strong></code></a> - Whether or not the angle of the free surface should be stored in history</p>
</li>
<li class="data-line-59">
<p><a href="#meta_integral_spline"><code><strong>integral_spline</strong></code></a> - Whether or not to use a spline for the boundary integral</p>
</li>
</ul>
</div>
</li>
</ul>
</div>
</li>
<li class="data-line-60">
<p><a href="#characteristics_"><code><strong>characteristics_</strong></code></a></p>
<div class="ulist data-line-61">
<ul>
<li class="data-line-61">
<p>Stores values that may represent intermediate steps- nothing in this struct should be modified.</p>
</li>
</ul>
</div>
</li>
<li class="data-line-62">
<p><a href="#regridding"><code><strong>regridding</strong></code></a></p>
<div class="ulist data-line-63">
<ul>
<li class="data-line-63">
<p>Stores parameters for the regridding scheme, used in <a href="#method_handle_regrid"><code><strong>handle_regrid()</strong></code></a>.</p>
<div class="ulist data-line-64">
<ul>
<li class="data-line-64">
<p><a href="#regridding_regrid_type"><code><strong>regrid_type</strong></code></a> - How the nodes are regridded</p>
</li>
<li class="data-line-65">
<p><a href="#regridding_threshold_type"><code><strong>threshold_type</strong></code></a> - When the nodes are regridded</p>
</li>
<li class="data-line-66">
<p><a href="#regridding_did_regrid"><code><strong>did_regrid</strong></code></a> - If the nodes were regridded this step</p>
</li>
</ul>
</div>
</li>
</ul>
</div>
</li>
</ul>
</div>
<div class="sect2 data-line-70">
<h3 id="boundary">bem_sim.boundary</h3>
<div class="paragraph data-line-72">
<p><code>boundary</code> is a structure that represents the boundary elements of the simulation, which is discretized into <code>N</code> nodes.</p>
</div>
<div class="paragraph data-line-74">
<p>For nodes on the free surface,
<code>FS_start &lt;= j &lt;= FS_end</code>, the nodes are interpolated using a quasi-spline scheme, where the geometry is interpolated by a cubic spline, and the values on the surface are interpolated linearly.</p>
</div>
<div class="paragraph data-line-77">
<p>On elements outside of the free surface, isoparametric elements of size <code>M</code> are used, stored in <a href="#interpolation_M"><code>interpolation.M</code></a>. Because of this, <code>FS_start</code>, <code>FS_end</code>, and <code>N</code> must take values that allow non-free-surface elements to be represented by consecutive, non-overlapping nodes. Specifically, regions between double nodes must consist of <code>kM + 1</code> nodes for some positive integer <code>k</code>.</p>
</div>
<div class="paragraph data-line-79">
<p><span class="image"><img src="element_seq.png" alt="element seq"></span></p>
</div>
<div class="sect4 data-line-82">
<h5 id="boundary_N">N - <span class="small">integer</span></h5>
<div class="paragraph data-line-83">
<p><code>N</code> represents number of nodes in the boundary, including double nodes. This dictates the length of <code>x</code>, <code>z</code>, and <code>doublenode</code>.</p>
</div>
</div>
<div class="sect4 data-line-86">
<h5 id="boundary_x">x, z - <span class="small">float array</span></h5>
<div class="paragraph data-line-87">
<p><code>x</code> and <code>z</code> are both arrays of length <code>N</code> that store the <em>x</em> and <em>z</em> coordinates of each node, respectively. On indices <code>j</code> where <code>doublenode(j) = 1</code>, we must have <code>x(j) = x(j+1)</code> and <code>z(j) = z(j+1)</code>.</p>
</div>
</div>
<div class="sect4 data-line-90">
<h5 id="boundary_doublenode">doublenode - <span class="small">logic array</span></h5>
<div class="paragraph data-line-91">
<p><code>doublenode</code> is an <code>N</code>-length array of logical values (0 or 1) that represent whether or not the corresponding node is a <a href="bem_method.html#doublenode" data-href="bem_method.html#doublenode">double node</a>. On indices <code>j</code> where <code>doublenode(j) = 1</code>, the <code>j</code><sup>th</sup> and <code>j+1</code><sup>th</sup> nodes must have the same position. That is, <code>x(j) = x(j+1)</code> and <code>z(j) = z(j+1)</code>.</p>
</div>
</div>
<div class="sect4 data-line-94">
<h5 id="boundary_fsstartend">FS_start, FS_end - <span class="small">integer</span></h5>
<div class="paragraph data-line-95">
<p><code>FS_start</code> and <code>FS_end</code> represent the node indices which determine the free surface nodes.</p>
</div>
</div>
<div class="sect4 data-line-98">
<h5 id="boundary_phiFS">phi_FS - <span class="small">float array</span></h5>
<div class="paragraph data-line-99">
<p><code>phi_FS</code> is an array of length <code>FS_end - FS_start + 1</code> that store the velocity potential \$\phi\$ along the free surface, where \$\phi\$ at node <code>FS_start &lt;= j &lt;= FS_end</code> is represented by <code>phi_FS(j - FS_start + 1)</code>.</p>
</div>
</div>
</div>
<div class="sect2 data-line-102">
<h3 id="interpolation">bem_sim.interpolation</h3>
<div class="paragraph data-line-104">
<p><code>interpolation</code>, <code>interpolation_FS</code>, and <code>interpolation_sliding</code> are structures that store the order of the Lagrange interpolation and the polynomial coefficients for such an interpolation. These structures share the format with <a href="functions.html#get_interpolation_struct" data-href="functions.html#get_interpolation_struct"><code>get_interpolation_struct()</code></a>, which is used to populate these fields.</p>
</div>
<div class="paragraph data-line-106">
<p><code>interpolation</code> specifies the order of the isoparametric elements on the non-free-surface boundary, while <code>interpolation_FS</code> determines the shape function of the sliding element on the free surface in the boundary integral calculation.
<code>interpolation_sliding</code> determines the sliding element used for surface derivative calculation, used in the time-stepping procedure, <a href="functions.html#step_sim" data-href="functions.html#step_sim"><code>step_sim()</code></a>.</p>
</div>
<div class="paragraph data-line-109">
<p>It is preferred for <code>interpolation_FS.M</code> to be odd so that an even number of collocation points are used so that the middle is a segment that the sliding element is based on, and <code>interpolation_sliding.M</code> to be even so that there is a center node for the derivatives to be calculated at.</p>
</div>
<div class="paragraph data-line-111">
<p>The values stored here are used both in <a href="functions.html#eval_Kn_Kd" data-href="functions.html#eval_Kn_Kd"><code>eval_Kn_Kd()</code></a> and <a href="functions.html#step_sim" data-href="functions.html#step_sim"><code>step_sim()</code></a>, when interpolating values on the boundary. On the free surface, <code>step_sim()</code> uses a sliding element of <code>interpolation.M+1</code> nodes to evaluate derivatives, while everywhere else is evaluated isoparametrically with an element of <code>interpolation.M+1</code> nodes. <code>step_sim()</code> uses <code>interpolation.M</code> instead of <code>interpolation_FS.M</code> because an odd number of collocation points is desirable. Specifically, <code>step_sim()</code> uses values at a node instead of a segment, so it is preferrable to operate on an element that has a node in the center.</p>
</div>
<div class="paragraph data-line-113">
<p>In <code>eval_Kn_Kd()</code>, the free surface is interpolated using a sliding element of  order <code>interpolation_FS.M</code>. The integrals between two nodes <code>k</code> and <code>k+1</code> are calculated on the middle segment, except close to the ends of the free surface, where the element would extend past the free surface if centered on the <code>k</code>,<code>k+1</code> segment.</p>
</div>
<div class="sect4 data-line-117">
<h5 id="interpolation_M">M - <span class="small">integer</span></h5>
<div class="paragraph data-line-118">
<p><code>M</code> represents the order of the Lagrange interpolation. <code>M+1</code> nodes are used, resulting in Lagrange polynomials of degree <code>M</code>.</p>
</div>
</div>
<div class="sect4 data-line-121">
<h5 id="interpolation_lagrange">Lagrange - <span class="small">float matrix</span></h5>
<div class="paragraph data-line-122">
<p><code>Lagrange</code> stores the coefficients of the Lagrange polynomials. For <code>M=4</code>, this is a \$5\times 5\$ matrix. For general <code>M</code> the matrix is \$(a_{i,j})\$ where</p>
</div>
<div class="exampleblock data-line-125">
<div class="content">
<div class="paragraph data-line-126">
<p>\[
    L_i(x) = \sum_{j=1}^{M+1} a_{i,j} x^{j-1} = \prod_{\begin{matrix}k=1\\k\ne i\end{matrix}}^{M+1} \frac{x - x_k}{x_i - x_k}
\]</p>
</div>
</div>
</div>
<div class="paragraph data-line-130">
<p>is the Lagrange polynomial for node \$i\$. For <code>interpolation.Lagrange</code> and <code>interpolation_sliding.Lagrange</code>, the interval \$\[0,1]\$ is used, with \$x_k = \frac{k}{M+1}\$. For <code>interpolation_FS.Lagrange</code>, the interval \$\[0,M]\$ is used, with \$x_k = k\$.</p>
</div>
</div>
<div class="sect4 data-line-133">
<h5 id="interpolation_lagrangep">Lagrange_prime - <span class="small">float matrix</span></h5>
<div class="paragraph data-line-134">
<p><code>Lagrange_prime</code> stores the coefficients of the derivatives of the Lagrange polynomials. For <code>M=4</code>, this is a \$5\times 4\$ matrix. For general <code>M</code> the matrix is \$(a_{i,j})\$ where</p>
</div>
<div class="exampleblock data-line-137">
<div class="content">
<div class="paragraph data-line-138">
<p>\[
    L_i'(x) = \sum_{j=1}^{M} a_{i,j} x^{j-1}
\]</p>
</div>
</div>
</div>
<div class="paragraph data-line-142">
<p>This means that if \$(b_{i,j})\$ is the matrix representing <code>Lagrange</code>, we have</p>
</div>
<div class="exampleblock data-line-145">
<div class="content">
<div class="paragraph data-line-146">
<p>\[
    a_{i,j} = jb_{i,j+1}
\]</p>
</div>
</div>
</div>
</div>
<div class="sect4 data-line-152">
<h5 id="interpolation_lagrangepp">Lagrange_primeprime - <span class="small">float matrix</span></h5>
<div class="paragraph data-line-153">
<p><code>Lagrange_primeprime</code> stores the coefficients of the second derivatives of the Lagrange polynomials. For <code>M=4</code>, this is a \$5\times 3\$ matrix. For general <code>M</code> the matrix is \$(a_{i,j})\$ where</p>
</div>
<div class="exampleblock data-line-156">
<div class="content">
<div class="paragraph data-line-157">
<p>\[
    L_i''(x) = \sum_{j=1}^{M-1} a_{i,j} x^{j-1}
\]</p>
</div>
</div>
</div>
<div class="paragraph data-line-161">
<p>This means that if \$(b_{i,j})\$ is the matrix representing <code>Lagrange</code>, we have</p>
</div>
<div class="exampleblock data-line-164">
<div class="content">
<div class="paragraph data-line-165">
<p>\[
    a_{i,j} =  j(j+1)b_{i,j+2}
\]</p>
</div>
</div>
</div>
</div>
</div>
<div class="sect2 data-line-171">
<h3 id="stepping">bem_sim.stepping</h3>
<div class="paragraph data-line-172">
<p><code>stepping</code> is a structure that holds information relevant to timestepping, which is handled by the <a href="#method_step"><code>step()</code></a> method.</p>
</div>
<div class="sect4 data-line-175">
<h5 id="stepping_t">t - <span class="small">float</span></h5>
<div class="paragraph data-line-176">
<p><code>t</code> represents the current time of the simulation. This is updated every time the simulation is stepped.</p>
</div>
</div>
<div class="sect4 data-line-179">
<h5 id="stepping_dt">dt - <span class="small">float</span></h5>
<div class="paragraph data-line-180">
<p><code>dt</code> represents the size of the time step. Every step increments <code>t</code> by <code>dt</code>. This value should be allowed to be modified inside and outside of the stepping code in order to support adaptive schemes.</p>
</div>
</div>
<div class="sect4 data-line-183">
<h5 id="stepping_store_dt">store_dt - <span class="small">float</span></h5>
<div class="paragraph data-line-184">
<p><code>store_dt</code> represents the time interval between writing values of the simulation into <a href="#history"><code>history</code></a>. If this value is less than or equal to <code>dt</code>, then every frame, a history update occurs.</p>
</div>
<div class="paragraph data-line-186">
<p>Every step, the last recorded time in <code>history</code> is compared to <code>stepping.t</code>. If the difference is greater than <code>store_dt</code>, a <a href="#method_update_history">history update call</a> is made.</p>
</div>
</div>
<div class="sect4 data-line-189">
<h5 id="stepping_courant_number">courant_number - <span class="small">positive float</span></h5>
<div class="paragraph data-line-190">
<p><code>courant_number</code> represents the Courant number \$u \frac{\Delta x}{\Delta t}\$, which is calculated in <a href="functions.html#step_sim" data-href="functions.html#step_sim"><code>step_sim()</code></a>. Hence, this value is set to the Courant number at the previous time step. \$\Delta t\$ is taken to be the time step size <code>dt</code>, \$\Delta x\$ is taken to be the minimum distance between two adjacent nodes, and \$u\$ is taken to be the maximum velocity \$\|\nabla\phi\|\$ on the free surface. This choice was made to keep nodes from colliding with each other, and may not perform well to maintain overall stability, in certain standing wave scenarios, for example.</p>
</div>
</div>
<div class="sect4 data-line-193">
<h5 id="stepping_courant_lock">courant_lock - <span class="small">logical</span></h5>
<div class="paragraph data-line-194">
<p>Each time step, the step size taken is determined by keeping either <code>dt</code> constant or <code>courant_number</code> constant. When <code>courant_lock</code> is true, <code>courant_number</code> is kept constant, so <code>dt</code> is set in order for that to be true. Otherwise, <code>dt</code> is kept constant, and <code>courant_number</code> is simply updated for the current time step.</p>
</div>
</div>
<div class="sect4 data-line-197">
<h5 id="stepping_timestep_method">timestep_method - <span class="small">string</span></h5>
<div class="paragraph data-line-198">
<p><code>timestep_method</code> represents the integration scheme used for time stepping. This may be a string of one of the following values:</p>
</div>
<table class="tableblock frame-all grid-all stretch data-line-201">
<caption class="title">Table 1. Time-stepping Methods</caption>
<colgroup>
<col style="width: 50%;">
<col style="width: 50%;">
</colgroup>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">value</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Description</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">'taylor2'</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Use a second order Taylor series method<br>
\$u_{j+1} = u_j + hf(u_j) + \frac{h}{2}f'(u_j)\$</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">'abm4'</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Use a 4th order Adams-Bashforth method<br>
\$u_{j+1} = u_j+h/24\left(55f(u_j)-59f(u_{j-1}) + 37f(u_{j-2}) - 9f(u_{j-3})\right)\$<br>
initiated by 'taylor2'.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">'abm2'</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Use a 2nd order Adams-Bashforth method<br>
\$u_{j+1} = u_j+h/2\left(3f(u_j)-f(u_{j-1})\right)\$<br>
initiated by 'taylor2'.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">'euler'</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Use Euler&#8217;s method<br>
\$u_{j+1} = u_j+hf(u_j)\$<br></p></td>
</tr>
</tbody>
</table>
</div>
</div>
<div class="sect2 data-line-221">
<h3 id="history">bem_sim.history</h3>
<div class="paragraph data-line-223">
<p><code>history</code> is a structure that stores information of prior time steps in the simulation. In the case of a static boundary, the information here is enough to recreate the simulation at a stored time step <code>time(i)</code> using <code>x_FS(i,:)</code>, <code>z_FS(i,:)</code>, and <code>phi_FS(i,:)</code>, but there is currently no support for doing this automatically, yet. Other fields hold data that may be relevant to measuring the <a href="bem_method.html#accuracy_checks" data-href="bem_method.html#accuracy_checks">accuracy of the simulation</a>. This structure is updated using the <a href="#method_update_history"><code>bem_sim.update_history()</code></a> method.</p>
</div>
<div class="paragraph data-line-225">
<p>This struct was created prior to netcdf saving, which is now the prefered way of storing history.</p>
</div>
<div class="sect4 data-line-228">
<h5 id="history_time">time - <span class="small">float array</span></h5>
<div class="paragraph data-line-229">
<p><code>time</code> represents the time corresponding to each index in the history. For example, the volume <code>volume(i)</code> is the calculated volume at time <code>time(i)</code>.</p>
</div>
</div>
<div class="sect4 data-line-232">
<h5 id="history_energy">energy, KE, PE - <span class="small">float array</span></h5>
<div class="paragraph data-line-233">
<p><code>energy</code> represents the calculated energy (see <a href="bem_method.html#accuracy_checks" data-href="bem_method.html#accuracy_checks">BEM accuracy checks</a>) at a given time step.
This is the sum of <code>KE</code> and <code>PE</code>.</p>
</div>
</div>
<div class="sect4 data-line-237">
<h5 id="history_volume">volume - <span class="small">float array</span></h5>
<div class="paragraph data-line-238">
<p><code>volume</code> represents the calculated volume (see <a href="bem_method.html#accuracy_checks" data-href="bem_method.html#accuracy_checks">BEM accuracy checks</a>) at a given time step.</p>
</div>
</div>
<div class="sect4 data-line-241">
<h5 id="history_x_FS">(x_FS, z_FS) or (x_full, z_full) - <span class="small">cell array of float arrays</span></h5>
<div class="paragraph data-line-242">
<p><code>x_FS</code> and <code>z_FS</code> represent the free surface node coordinates respectively at a given time step. <code>x_FS{i}</code> is equal to <a href="#boundary_x"><code>boundary.x</code></a>(<a href="#boundary_fsstartend"><code>FS_start:FS_end</code></a>) when the simulation was at time <code>time(i)</code>. This is populated if <a href="#meta_history_store_full_boundary"><code><strong>meta.history_sture_full_boundary</strong></code></a> is set to false.</p>
</div>
<div class="paragraph data-line-244">
<p>Otherwise, <code>x_full</code> and <code>z_full</code> are populated, representing the full boundary node coordinates at a given time step. <code>z_FS{i}</code> is equal to <a href="#boundary_x"><code>boundary.x</code></a> when the simulation was at time <code>time(i)</code>.</p>
</div>
</div>
<div class="sect4 data-line-247">
<h5 id="history_phi_FS">phi_FS - <span class="small">cell array of float arrays</span></h5>
<div class="paragraph data-line-248">
<p><code>phi_FS</code> represents the free surface velocity potential at a given time step. <code>phi_FS{i}</code> is equal to <a href="#boundary_phiFS"><code>boundary.phi_FS</code></a> when the simulation was at time <code>time(i)</code>.</p>
</div>
</div>
<div class="sect4 data-line-251">
<h5 id="history_beta_FS">beta_FS - <span class="small">cell array of float arrays</span></h5>
<div class="paragraph data-line-252">
<p><code>beta_FS</code> represents the free surface angles at a given time step. <code>beta_FS{i}</code> is, at time <code>time(i)</code>, calculated using the sliding element at each node, where the derivatives in \$x\$ and \$z\$ are taken and plugged into <code>atan2()</code>.</p>
</div>
</div>
<div class="sect4 data-line-255">
<h5 id="history_net_flux">net_flux - <span class="small">float array</span></h5>
<div class="paragraph data-line-256">
<p><code>net_flux</code> represents the calculated integral</p>
</div>
<div class="exampleblock data-line-258">
<div class="content">
<div class="paragraph data-line-259">
<p>\[\int_{\Gamma} \phi_n ~ d\Gamma\]</p>
</div>
</div>
</div>
<div class="paragraph data-line-261">
<p>(see <a href="bem_method.html#accuracy_checks" data-href="bem_method.html#accuracy_checks">BEM accuracy checks</a>) at a given time step.</p>
</div>
</div>
<div class="sect4 data-line-264">
<h5 id="history_mean_water_level">mean_water_level - <span class="small">float array</span></h5>
<div class="paragraph data-line-265">
<p><code>mean_water_level</code> represents the calculated mean of \$\eta\$ as</p>
</div>
<div class="exampleblock data-line-267">
<div class="content">
<div class="paragraph data-line-268">
<p>\[\int_{\Gamma_{FS}} z ~ dx\]</p>
</div>
</div>
</div>
<div class="paragraph data-line-270">
<p>(see <a href="bem_method.html#accuracy_checks" data-href="bem_method.html#accuracy_checks">BEM accuracy checks</a>) at a given time step.</p>
</div>
</div>
<div class="sect4 data-line-273">
<h5 id="history_condition_number">condition_number - <span class="small">float array</span></h5>
<div class="paragraph data-line-274">
<p><code>condition_number</code> represents the condition number of the matrix \$A\$
(see <a href="bem_method.html#system_of_equations" data-href="bem_method.html#system_of_equations">BEM System of Equations</a>) at a given time step. This gives a general idea of how well conditioned the system is, which may not be as helpful in determining accuracy as the other metrics above.</p>
</div>
</div>
</div>
<div class="sect2 data-line-278">
<h3 id="meta">bem_sim.meta</h3>
<div class="paragraph data-line-279">
<p><code>meta</code> is a structure that stores metadata of the simulation, which may give information about the simulation or how to plot it.</p>
</div>
<div class="sect4 data-line-282">
<h5 id="meta_a0">has_a0 - <span class="small">flag (logical)</span></h5>
<div class="paragraph data-line-283">
<p><code>has_a0</code> tells the simulation whether or not there is an <code>a0</code> value attributed
to the simulation. <code>a0</code> is also stored in <code>bem_sim.meta</code> and may exist even if
<code>has_a0</code> is false, in which case it does not have a meaningful value and should be ignored.</p>
</div>
<div class="paragraph data-line-287">
<p><code>a0</code> takes the value of a single float and represents the amplitude or wave height of an initial condition. This value is used in graphing, and when <code>has_a0</code>
is true, the method <a href="#method_plot_FS"><code>bem_sim.plot_FS()</code></a> plots the nondimensional quantity \$\frac{\eta}{a_0}\$ on the y-axis.</p>
</div>
</div>
<div class="sect4 data-line-292">
<h5 id="plot_ylim">plot_ylim, plot_xlim - <span class="small">float array</span></h5>
<div class="paragraph data-line-293">
<p><code>plot_ylim</code> and <code>plot_xlim</code> respectively represent the <code>ylim</code> and <code>xlim</code> parameters used for plotting. The default value for <code>plot_ylim</code> is \$\[-1.5,1.5]\$. The default value for <code>plot_xlim</code> is \$\[x_0 -\frac{x_1-x_0}{20},x_1 + \frac{x_1-x_0}{20} ]\$, where \$x_0\$ is the smallest x-value on the boundary upon initialization and \$x_1\$ is the largest. Note that <code>plot_ylim</code> is taken as is, even when the y-axis is nondimensionalized, so in the case that <code>has_a0</code> is true, the y-values in \$\[-1.5a_0, 1.5a_0]\$ of the free surface are plotted because <a href="#method_plot_FS"><code>bem_sim.plot_FS()</code></a> scales the y-axis by a factor of \$a_0\$.</p>
</div>
</div>
<div class="sect4 data-line-296">
<h5 id="meta_sim_parallel_workers">sim_parallel_workers - <span class="small">positive integer</span></h5>
<div class="paragraph data-line-297">
<p><code>sim_parallel_workers</code> represents the number of worker threads in parallel for-loops used during intensive tasks, in particular, the integration in <a href="functions.html#eval_Kn_Kd" data-href="functions.html#eval_Kn_Kd"><code>eval_Kn_Kd()</code></a>.</p>
</div>
</div>
<div class="sect4 data-line-300">
<h5 id="meta_g">g - <span class="small">float</span></h5>
<div class="paragraph data-line-301">
<p><code>g</code> is the gravitational constant for the simulation. By default this is \$9.81\$.</p>
</div>
</div>
<div class="sect4 data-line-304">
<h5 id="meta_L">L - <span class="small">float</span></h5>
<div class="paragraph data-line-305">
<p><code>L</code> is the length of the simulation along the x-direction. This is not used directly by the simulation.</p>
</div>
</div>
<div class="sect4 data-line-308">
<h5 id="meta_wall_resolution_factor">wall_resolution_factor - <span class="small">positive float</span></h5>
<div class="paragraph data-line-309">
<p><code>wall_resolution_factor</code> references the node spacing difference between the walls and the rest of the boundary. This is used in generation, where the wall nodes are placed so that the node spacing is rougly <code>wall_resolution_factor</code> times <code>dx</code>, where <code>dx</code> is the free surface node spacing.</p>
</div>
</div>
<div class="sect4 data-line-312">
<h5 id="meta_history_store_full_boundary">history_store_full_boundary - <span class="small">logical</span></h5>
<div class="paragraph data-line-313">
<p><code>history_store_full_boundary</code> specifies whether or not to store the full boundary in each history snapshot. When true, <code>history.x_full</code> and <code>history.z_full</code> are populated with the entire boundary. Otherwise, <code>history.x_FS</code> and <code>history.z_FS</code> are populated with only the free surface nodes. This should not be modified in the middle of a simulation.</p>
</div>
<div class="paragraph data-line-315">
<p>This value is used in <a href="#method_rollback"><code><strong>rollback()</strong></code></a>, which assumes that the non-free surface boundary does not change when <code>history_store_full_boundary</code> is set to false. In general, <code>history_store_full_boundary</code> should be set to true.</p>
</div>
</div>
<div class="sect4 data-line-318">
<h5 id="meta_history_store_angle_FS">history_store_angle_FS - <span class="small">logical</span></h5>
<div class="paragraph data-line-319">
<p><code>history_store_angle_FS</code> specifies whether or not to store the angle of the free surface in each history snapshot. When true, <code>history.beta</code> is populated with the calculated angle at each free surface node. The stored values are a result from calling <code>atan2()</code> on surface derivatives, so it is possible for this value to have distinct discontinuities jumping between \$\pi\$ and \$-\pi\$. \$\beta\$ is calculated using the sliding element.</p>
</div>
</div>
<div class="sect4 data-line-322">
<h5 id="meta_integral_spline">integral_spline - <span class="small">logical</span></h5>
<div class="paragraph data-line-323">
<p><code>integral_spline</code> determines if the integral on the free surface is done using a sliding isoparametric element or the spline.</p>
</div>
</div>
</div>
<div class="sect2 data-line-326">
<h3 id="characteristics_">bem_sim.characteristics_</h3>
<div class="paragraph data-line-327">
<p><code>characteristics_</code> is a structure that should be considered weakly <em>private</em>.
Values are stored that may represent intermediate steps, so nothing in this struct should be modified.</p>
</div>
</div>
<div class="sect2 data-line-331">
<h3 id="regridding">bem_sim.regridding</h3>
<div class="paragraph data-line-332">
<p><code>regridding</code> stores parameters that are used by <a href="#method_handle_regrid"><code><strong>handle_regrid()</strong></code></a> for automatic regridding.</p>
</div>
<div class="sect4 data-line-335">
<h5 id="regridding_regrid_type">regrid_type - <span class="small">string</span></h5>
<div class="paragraph data-line-336">
<p><code>regrid_type</code> provides the method used for regridding once it is decided that regridding should be done. <code>regrid_type</code> takes one of the following values</p>
</div>
<table class="tableblock frame-all grid-all stretch data-line-339">
<caption class="title">Table 2. regrid_type values</caption>
<colgroup>
<col style="width: 50%;">
<col style="width: 50%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Value</th>
<th class="tableblock halign-left valign-top">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>'none'</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">No regridding is performed.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>'shift_by_curve3d'</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Uses <code>curve_renode_3d()</code> to evenly
distribute by curve length in \$(x,z,a\frac{\phi}{u_{max}})\$
coordinates, where \$a\$ is specified by
regrid_param{1}, and \$u_{max}\$ is calculated as
the maximum \$\sqrt{\phi_s^2 + \phi_n^2}\$ on the free
surface. The same number of nodes are used, and
regrid_param{2} specifies the interpolation scheme,
which is passed as the interp_scheme argument into
the <code>curve_3d</code> functions.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>'shift_by_curve2d_normu'</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">uses <code>curve_renode_by_integral()</code>
using the integrand \$\sqrt{1 + (a\frac{|u|}{u_{max}})^2}\$, which
is similar to <code>shift_by_curve3d</code>, except
\$|\nabla(\phi)|^2\$ is used instead of \$|\phi_s|^2\$. Like
<code>shift_by_curve3d</code>, regrid_param{1} specifies \$a\$.</p></td>
</tr>
</tbody>
</table>
</div>
<div class="sect4 data-line-365">
<h5 id="regridding_threshold_type">threshold_type - <span class="small">string</span></h5>
<div class="paragraph data-line-366">
<p><code>threshold_type</code> provides the method used to determine whether or not the boundary should be regridded on this time step.</p>
</div>
<table class="tableblock frame-all grid-all stretch data-line-369">
<caption class="title">Table 3. threshold_type values</caption>
<colgroup>
<col style="width: 50%;">
<col style="width: 50%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Value</th>
<th class="tableblock halign-left valign-top">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>'manual'</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">regridding is never performed unless force is
set to 1 in the <code>handle_regrid()</code> call.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>'factor_global'</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">regridding is performed when the
metric differs from the desired value of the metric
by a factor of threshold_param{1}. for
shift_by_curve3d, this metric is the segment
length/total length in 3d. The factor must be
greater than 1.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>'factor_local'</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">regridding is performed when the
metric differs from the metric of adjacent segments
by a factor of threshold_param{1}. for
shift_by_curve3d, this metric is the segment
length/total length in 3d. The factor must be
greater than 1.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>'factor_global_local'</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">uses both modes <em>factor_desired</em>
and <em>factor_neighbors</em> with factors
threshold_param{1} and threshold_param{2},
respectively.</p></td>
</tr>
</tbody>
</table>
</div>
<div class="sect4 data-line-400">
<h5 id="regridding_did_regrid">did_regrid - <span class="small">logical</span></h5>
<div class="paragraph data-line-401">
<p><code>did_regrid</code> is a value that is set to true if the boundary was regridded since the last time step.</p>
</div>
</div>
</div>
</div>
</div>
<div class="sect1 data-line-404">
<h2 id="methods">Methods</h2>
<div class="sectionbody">
<div class="paragraph data-line-406">
<p><code>bem_sim</code> has the following methods:</p>
</div>
<div class="sect2 data-line-409">
<h3 id="method_constructor">Constructor: bem_sim()</h3>
<div class="listingblock data-line-411">
<div class="content">
<pre class="highlight"><code class="language-matlab" data-lang="matlab">obj = bem_sim()</code></pre>
</div>
</div>
<div class="paragraph data-line-415">
<p>Initializes a bem_sim class object. The constructor takes keyword optional arguments, handled by <code>inputParser</code>.</p>
</div>
<table class="tableblock frame-all grid-all stretch data-line-418">
<caption class="title">Table 4. bem_sim() optional arguments</caption>
<colgroup>
<col style="width: 25%;">
<col style="width: 25%;">
<col style="width: 25%;">
<col style="width: 25%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Argument</th>
<th class="tableblock halign-left valign-top">Type</th>
<th class="tableblock halign-left valign-top">Default</th>
<th class="tableblock halign-left valign-top">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">type</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">character array - of specific values</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>'standing_wave'</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Determines the type of simulation, setting the initial condition as necessary. <a href="#method_constructor_type">This table</a> shows the values type can take.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">L</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">positive float, or <code>'default'</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>'default'</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">The length of the simulation in the x-direction. The default value depends on the <a href="#method_constructor_type">type</a> of simulation.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">a0</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">positive float, or <code>'default'</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>'default'</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">The amplitude or height of the initial condition. This can be seen as a nondimensionalizing factor that sets the initial condition to a height of 1. The default value depends on the <a href="#method_constructor_type">type</a> of simulation.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Nx</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">positive integer</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">100</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Number of nodes along the free surface.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">h</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">positive float</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">1</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">characteristic water depth</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">dt</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">positive floating point number</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">0.01</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">The time step size of the simulation. This gets stored in <a href="#stepping_dt"><code>stepping.dt</code></a>.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">store_dt</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">positive float</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">0.25</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">The time elapsed between each history store. This gets stored in <a href="#stepping_store_dt"><code>stepping.store_dt</code></a>.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">g</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">positive float</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">9.81</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Acceleration due to gravity This gets stored in <a href="#meta_g"><code>meta.g</code></a>.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">parallel_workers</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">nonnegative integer</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">1</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Number of workers in the thread pool to use. This is given to the value <a href="#meta_sim_parallel_workers"><code>bem_sim.meta.sim_parallel_workers</code></a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">timestep_method</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">character array - of specific values</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>'taylor2'</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Determines the time-stepping integration scheme. This takes values of and gets stored into <a href="#stepping_timestep_method"><code>stepping.timestep_method</code></a>.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">wall_resolution_factor</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">positive float</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">1</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">The number of wall nodes are increased (roughly) by this factor. The number of nodes are kept to be 1 mod <a href="#interpolation"><code>M</code></a>.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">history_store_full_boundary</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">logical value</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">1</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Whether or not to store the entire boundary into history instead of just
the free surface.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">history_store_angle_FS</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">logical value</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">0</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Whether or not to store the angle of the free surface into history.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">x0</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">float</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">20</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">The value for an initial \$x\$ position. This is used in the <code>soliton_reflect</code> initial condition to specify the peak of the solitary wave.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">plot_xlim</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">array of 2 floats or <code>'default'</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>'default'</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">What will be passed into xlim when the boundary gets plotted, using <a href="#method_plot_FS"><code>obj.plot_FS()</code></a> or <a href="#method_plot_full"><code>obj.plot_full()</code></a>.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">plot_ylim</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">array of 2 floats or <code>'default'</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>'default'</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">What will be passed into ylim when the boundary gets plotted, using <a href="#method_plot_FS"><code>obj.plot_FS()</code></a> or <a href="#method_plot_full"><code>obj.plot_full()</code></a>.</p></td>
</tr>
</tbody>
</table>
<table id="method_constructor_type" class="tableblock frame-all grid-all stretch data-line-505">
<caption class="title">Table 5. type values</caption>
<colgroup>
<col style="width: 25%;">
<col style="width: 25%;">
<col style="width: 25%;">
<col style="width: 25%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Value</th>
<th class="tableblock halign-left valign-top">Description</th>
<th class="tableblock halign-left valign-top">Default <code>L</code></th>
<th class="tableblock halign-left valign-top">Default <code>a0</code></th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>'standing_wave'</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Start with an initial condition of the cosine standing wave. This is the same condition the <a href="tests.html#standingwave" data-href="tests.html#standingwave">standing wave test</a> uses.</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">\$10\$</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">\$10^{-4}\$</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>'soliton_reflect'</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Start with a soliton initial condition. This is the same condition the <a href="tests.html#bouncingsoliton" data-href="tests.html#bouncingsoliton">bouncing solitary wave test</a> uses.</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">\$100\$</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">\$0.1\$</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>'empty'</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Leaves the boundary empty to be set after construction.</p></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"></td>
</tr>
</tbody>
</table>
</div>
<div class="sect2 data-line-525">
<h3 id="method_add_free_surface_nodes">bem_sim.add_free_surface_nodes()</h3>
<div class="listingblock data-line-527">
<div class="content">
<pre class="highlight"><code class="language-matlab" data-lang="matlab">obj2 = obj.add_free_surface_nodes(xi)</code></pre>
</div>
</div>
<div class="paragraph data-line-530">
<p>Adds new free surface nodes at the specified parameterization indices, interpolating as necessary.</p>
</div>
<div class="paragraph data-line-532">
<p>A node is placed at each value of <code>xi</code>. For each <code>xi(i)</code> written as \$\xi_i\$, set \$k+s = \xi_i\$ so that \$k\$ is an integer and \$0 &lt;= s &lt; 1\$. The
node is added in segment \$k\$ of the free surface (between nodes \$\text{FS_start}+k\$ and \$\text{FS_start}+k+1\$) and offset by \$s\$, which uniformly distributes the node onto the segment by arc
length (\$s = 0\$ corresponds to node \$\text{FS_start}+k\$ and \$s = 0.5\$ corresponds to the midpoint of segment \$k\$). The arc length is calculated using standard Gauss-Legendre Quadrature.</p>
</div>
<div class="paragraph data-line-536">
<p><code>tol</code> can be specified as an optional argument (default \$10^{-3}\$)
and is the allowed deviation \$s\$ from its actual value in node
placement. The bisection method is used, so <code>tol</code> specifies
the maximum domain size before termination.</p>
</div>
<div class="paragraph data-line-541">
<p>this method updates <a href="#characteristics_"><code>characteristics_</code></a> prior to addition and
sets characteristics_.ctime to <code>'null'</code> so the next
<a href="#method_update_characteristics">characteristics update</a> will automatically call <a href="functions.html#eval_Kn_Kd" data-href="functions.html#eval_Kn_Kd"><code>eval_Kn_Kd()</code></a>.</p>
</div>
<table class="tableblock frame-all grid-all stretch data-line-546">
<caption class="title">Table 6. add_free_surface_nodes arguments</caption>
<colgroup>
<col style="width: 33.3333%;">
<col style="width: 33.3333%;">
<col style="width: 33.3334%;">
</colgroup>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Argument</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Type</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Description</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">xi</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">float array</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">List of positions to add nodes to. This should stay between 0 and <a href="#boundary_fsstartend"><code>FS_end - FS_start</code></a>, avoiding values close to integers in order to not create quasi-singularities<sup>[cit]</sup>.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">tol</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">float (optional)</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Allowed tolerance for arc-length-based positioning. Default is \$10^{-3}\$</p></td>
</tr>
</tbody>
</table>
</div>
<div class="sect2 data-line-558">
<h3 id="method_gen_mat_b">bem_sim.gen_mat_b()</h3>
<div class="listingblock data-line-560">
<div class="content">
<pre class="highlight"><code class="language-matlab" data-lang="matlab">obj.gen_mat_b(bt, bv);</code></pre>
</div>
</div>
<div class="paragraph data-line-564">
<p>Generates a column vector \$b\$ that can be used along side <a href="#characteristics_"><code>bem_sim.characteristics_</code></a><code>.mat_A</code> to solve for a system of the missing values.</p>
</div>
<table class="tableblock frame-all grid-all stretch data-line-567">
<caption class="title">Table 7. gen_mat_b arguments</caption>
<colgroup>
<col style="width: 33.3333%;">
<col style="width: 33.3333%;">
<col style="width: 33.3334%;">
</colgroup>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Argument</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Type</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Description</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">bt</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">length-<a href="#boundary_N"><code>N</code></a> logical array</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">For each node, what time of boundary it is. When <code>bv</code> specifies a potential quantity \$u\$, <code>bt</code> should be set to 0. When <code>bv</code> specifies a normal derivative quantity \$q\$, <code>bt</code> should be set to 1.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">bv</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">length-<a href="#boundary_N"><code>N</code></a> float array</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">For each node, the given value at that node.</p></td>
</tr>
</tbody>
</table>
<div class="paragraph data-line-578">
<p>Because <code>mat_A</code> is purely a geometric quantity and not dependent on the values <code>bv</code>, <code>mat_A</code> only needs to be generated once every time step. This method handles generating <code>mat_b</code>, so the system can be solved using</p>
</div>
<div class="listingblock data-line-581">
<div class="content">
<pre class="highlight"><code class="language-matlab" data-lang="matlab">newvals = (obj.characteristics_.mat_A\obj.gen_mat_b(bt, bv))';
u = bt.*newvals + (1-bt).*bv;
q = (1-bt).*newvals + bt.*bv;</code></pre>
</div>
</div>
</div>
<div class="sect2 data-line-590">
<h3 id="method_handle_regrid">bem_sim.handle_regrid()</h3>
<div class="listingblock data-line-592">
<div class="content">
<pre class="highlight"><code class="language-matlab" data-lang="matlab">obj = obj.handle_regrid(force);</code></pre>
</div>
</div>
<div class="paragraph data-line-596">
<p>Checks and preforms regridding according to the <code>regridding</code> struct of the object.</p>
</div>
<table class="tableblock frame-all grid-all stretch data-line-599">
<caption class="title">Table 8. handle_regrid arguments</caption>
<colgroup>
<col style="width: 33.3333%;">
<col style="width: 33.3333%;">
<col style="width: 33.3334%;">
</colgroup>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Argument</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Type</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Description</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">force</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">logical</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Whether or not threshold conditions should be ignored. When <code>force</code> is true, regridding occurs no matter what. Otherwise, the threshold conditions are used.</p></td>
</tr>
</tbody>
</table>
</div>
<div class="sect2 data-line-610">
<h3 id="method_interior_eval">bem_sim.interior_eval()</h3>
<div class="listingblock data-line-612">
<div class="content">
<pre class="highlight"><code class="language-matlab" data-lang="matlab">phi = obj.interior_eval(x,z);</code></pre>
</div>
</div>
<div class="paragraph data-line-616">
<p>Calculates the value of \$phi\$ on an interior point of the boundary, using the <a href="bem_method.html#bie_numerical" data-href="bem_method.html#bie_numerical">boundary integral equation</a>. <code>interior_eval()</code> returns the product \$\alpha phi\$, where \$\alpha = 1\$ on the interior.</p>
</div>
<table class="tableblock frame-all grid-all stretch data-line-620">
<caption class="title">Table 9. interior_eval arguments</caption>
<colgroup>
<col style="width: 33.3333%;">
<col style="width: 33.3333%;">
<col style="width: 33.3334%;">
</colgroup>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Argument</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Type</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Description</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">x</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">float</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">x-coordinate of the point at which to evaluate \$phi\$</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">z</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">float</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">z-coordinate of the point at which to evaluate \$phi\$</p></td>
</tr>
</tbody>
</table>
</div>
<div class="sect2 data-line-632">
<h3 id="method_is_point_inside">bem_sim.is_point_inside()</h3>
<div class="listingblock data-line-634">
<div class="content">
<pre class="highlight"><code class="language-matlab" data-lang="matlab">inside = obj.is_point_inside(xp,zp);</code></pre>
</div>
</div>
<div class="paragraph data-line-638">
<p>Returns whether or not the point \$(x_p,z_p)\$ lies inside the boundary. This uses the even-odd rule and approximates the surface as piecewise linear.</p>
</div>
<table class="tableblock frame-all grid-all stretch data-line-642">
<caption class="title">Table 10. is_point_inside arguments</caption>
<colgroup>
<col style="width: 33.3333%;">
<col style="width: 33.3333%;">
<col style="width: 33.3334%;">
</colgroup>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Argument</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Type</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Description</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">xp</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">float</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">x-coordinate of the point to evaluate</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">zp</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">float</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">z-coordinate of the point to evaluate</p></td>
</tr>
</tbody>
</table>
</div>
<div class="sect2 data-line-654">
<h3 id="method_plot_FS">bem_sim.plot_FS()</h3>
<div class="listingblock data-line-656">
<div class="content">
<pre class="highlight"><code class="language-matlab" data-lang="matlab">obj.plot_FS(omega);</code></pre>
</div>
</div>
<div class="paragraph data-line-660">
<p>Plots the free surface onto figure 1.
If omega is given as an optional argument, the title will
show the fraction of a period the simulation is currently at. If omega is not given, then omega in the object is used if it exists. Otherwise, dimensionalized time is shown.</p>
</div>
<table class="tableblock frame-all grid-all stretch data-line-665">
<caption class="title">Table 11. plot_FS arguments</caption>
<colgroup>
<col style="width: 33.3333%;">
<col style="width: 33.3333%;">
<col style="width: 33.3334%;">
</colgroup>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Argument</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Type</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Description</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">omega</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">number (optional)</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">angular velocity of the simulation</p></td>
</tr>
</tbody>
</table>
<div class="paragraph data-line-672">
<p>If <a href="#meta_a0"><code>obj.meta.has_a0</code></a> is true, then the y-axis is scaled by \$\frac{1}{a_0}\$.</p>
</div>
</div>
<div class="sect2 data-line-675">
<h3 id="method_plot_full">bem_sim.plot_full()</h3>
<div class="listingblock data-line-677">
<div class="content">
<pre class="highlight"><code class="language-matlab" data-lang="matlab">obj.plot_full(omega);</code></pre>
</div>
</div>
<div class="paragraph data-line-681">
<p>Plots the entire boundary onto figure 1.
Like <code>plot_FS()</code>, if omega is given as an optional argument, the title will
show the fraction of a period the simulation is currently at. If omega is not given, then omega in the object is used if it exists. Otherwise, dimensionalized time is shown.</p>
</div>
<table class="tableblock frame-all grid-all stretch data-line-686">
<caption class="title">Table 12. plot_FS arguments</caption>
<colgroup>
<col style="width: 33.3333%;">
<col style="width: 33.3333%;">
<col style="width: 33.3334%;">
</colgroup>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Argument</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Type</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Description</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">omega</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">number (optional)</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">angular velocity of the simulation</p></td>
</tr>
</tbody>
</table>
</div>
<div class="sect2 data-line-694">
<h3 id="method_remove_free_surface_nodes">bem_sim.remove_free_surface_nodes()</h3>
<div class="listingblock data-line-696">
<div class="content">
<pre class="highlight"><code class="language-matlab" data-lang="matlab">obj2 = obj.remove_free_surface_nodes(xi)</code></pre>
</div>
</div>
<div class="paragraph data-line-699">
<p>Removes free surface nodes at the specified indices.</p>
</div>
<div class="paragraph data-line-701">
<p><code>nodes</code> is an array of integers, where <code>k = nodes(i)</code> requests
the node indexed by <code>FS_start + k</code> to be removed. So nodes
should take values between <code>1</code> and <code>FS_end-FS_start-1</code>.</p>
</div>
<table class="tableblock frame-all grid-all stretch data-line-706">
<caption class="title">Table 13. remove_free_surface_nodes arguments</caption>
<colgroup>
<col style="width: 33.3333%;">
<col style="width: 33.3333%;">
<col style="width: 33.3334%;">
</colgroup>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Argument</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Type</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Description</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">nodes</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">integer array</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">A list of node indices which should be removed. Any indices outside the allowable rangle is removed.</p></td>
</tr>
</tbody>
</table>
</div>
<div class="sect2 data-line-715">
<h3 id="method_rollback">bem_sim.rollback()</h3>
<div class="listingblock data-line-717">
<div class="content">
<pre class="highlight"><code class="language-matlab" data-lang="matlab">obj_early = obj.rollback(t);</code></pre>
</div>
</div>
<div class="paragraph data-line-721">
<p>Restores a prior time in the simulation. Values are taken from <a href="#history"><code>bem_sim.history</code></a>, where the closest time to <code>t</code> is taken and placed in the boundary. This method expects the non-free-surface boundary to remain unchanged and that no double nodes exist on the free surface except on the ends. The number of free surface nodes is allowed to change.</p>
</div>
<table class="tableblock frame-all grid-all stretch data-line-724">
<caption class="title">Table 14. rollback arguments</caption>
<colgroup>
<col style="width: 33.3333%;">
<col style="width: 33.3333%;">
<col style="width: 33.3334%;">
</colgroup>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Argument</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Type</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Description</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">t</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">number</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">time to roll back to</p></td>
</tr>
</tbody>
</table>
</div>
<div class="sect2 data-line-733">
<h3 id="method_step">bem_sim.step()</h3>
<div class="listingblock data-line-735">
<div class="content">
<pre class="highlight"><code class="language-matlab" data-lang="matlab">obj = obj.step();</code></pre>
</div>
</div>
<div class="paragraph data-line-739">
<p>Steps the simulation forward by <code>dt</code>, delegating to the <a href="functions.html#step_sim" data-href="functions.html#step_sim"><code>step_sim()</code></a> function. This function takes no arguments.</p>
</div>
</div>
<div class="sect2 data-line-742">
<h3 id="method_update_characteristics">bem_sim.update_characteristics()</h3>
<div class="listingblock data-line-744">
<div class="content">
<pre class="highlight"><code class="language-matlab" data-lang="matlab">obj = obj.update_characteristics();</code></pre>
</div>
</div>
<div class="paragraph data-line-748">
<p>Updates the <a href="#characteristics_"><code>bem_sim.characteristics_</code></a> property for the current time step if it has not already been updated. <code>bem_sim.characteristics_.ctime</code> is compared to <a href="#stepping_t"><code>bem_sim.stepping.t</code></a>. If they are equal, then nothing is done. If they are unequal, then a call to <a href="functions.html#eval_Kn_Kd" data-href="functions.html#eval_Kn_Kd"><code>eval_Kn_Kd()</code></a> is made to update the <code>characteristics_</code> property. This function takes no arguments.</p>
</div>
</div>
<div class="sect2 data-line-751">
<h3 id="method_update_history">bem_sim.update_history()</h3>
<div class="listingblock data-line-753">
<div class="content">
<pre class="highlight"><code class="language-matlab" data-lang="matlab">obj = obj.update_history();</code></pre>
</div>
</div>
<div class="paragraph data-line-757">
<p>Appends values of the current state to the <a href="#history"><code>bem_sim.history</code></a> property when sufficient time has passed. This occurs if <code>history</code> is empty, or the time of the simulation, <a href="#stepping_t"><code>bem_sim.stepping.t</code></a>, minus the last stored <a href="#history_time"><code>history.time</code></a> element is greater than <a href="#stepping_dt_store"><code>bem_sim.stepping.dt_store</code></a>, minus a padding term \$10^{-12}\$. This function takes no arguments.</p>
</div>
</div>
</div>
</div>
</div>
<div id="footer">
<div id="footer-text">
Last updated 2022-04-20 16:16:43 -0700
</div>
</div>
<script type="text/x-mathjax-config">
MathJax.Hub.Config({
  messageStyle: "none",
  tex2jax: {
    inlineMath: [["\\(", "\\)"]],
    displayMath: [["\\[", "\\]"]],
    ignoreClass: "nostem|nolatexmath"
  },
  asciimath2jax: {
    delimiters: [["\\$", "\\$"]],
    ignoreClass: "nostem|noasciimath"
  },
  TeX: { equationNumbers: { autoNumber: "none" } }
})
MathJax.Hub.Register.StartupHook("AsciiMath Jax Ready", function () {
  MathJax.InputJax.AsciiMath.postfilterHooks.Add(function (data, node) {
    if ((node = data.script.parentNode) && (node = node.parentNode) && node.classList.contains("stemblock")) {
      data.math.root.display = "block"
    }
    return data
  })
})
</script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.9/MathJax.js?config=TeX-MML-AM_HTMLorMML"></script>
</body>
</html>